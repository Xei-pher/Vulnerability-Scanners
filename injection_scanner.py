import requests
import argparse
import logging

# Configure logging
logging.basicConfig(level=logging.INFO, format='%(asctime)s - %(levelname)s - %(message)s')

def test_sql_injection(url, payloads):
    for payload in payloads:
        data = {"username": payload, "password": "password"}
        try:
            response = requests.post(url, data=data)
            if "Welcome" in response.text:
                logging.info(f"SQL Injection vulnerability detected with payload: {payload}")
        except requests.RequestException as e:
            logging.error(f"Request failed for payload {payload}: {e}")

if __name__ == "__main__":
    parser = argparse.ArgumentParser(description="SQL Injection Tester")
    parser.add_argument("url", help="URL to test for SQL injection")
    parser.add_argument("payloads", nargs='+', help="List of payloads to test")
    args = parser.parse_args()

    logging.info(f"Testing URL: {args.url}")
    test_sql_injection(args.url, args.payloads)
